<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="pragma" content="no-cache" />
  <meta http-equiv="cache-control" content="no-cache" />
  <meta http-equiv="expires" content="0" />
  <meta name="viewport"
    content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
  <title>Syberh Hybrid API</title>
</head>

<body>
  <button onclick="requestOne()">示例一</button>
  <button onclick="requestTwo()">示例二</button>

  <div id="text"></div><br>

示例一：直接执行JS代码，来实现调用JS 实现的API。此方法可以用来实现Native直接调用JS实现的方法。为了兼容h5模式和实现原生直接调用js方法，采用此模式实现。<br>
示例二：发送一个消息,JS中使用navigator.qt.onmessage接受。为了兼容后续高版本的实现(QtWebEngine)。

  <script type="text/javascript" src="lib/vconsole.min.js"></script>
  <script>
    var vConsole = new VConsole()
    var JSBridge = {};
    var firstCallbackId = getRandomNum();//请求标识
    var secondCallbackId = getRandomNum();//请求标识

    // min:随机数的最小值，max:随机数的最大值
    function getRandomNum(){
        var Min = 10000000;
        var Max = 99999999;
        var Range = Max - Min;
        var Rand = Math.random();
        return(Min + Math.round(Rand * Range));
    }

    // 接收webview信息
    JSBridge._handleMessageFromNative = function (data) {
      if (data.callbackId == firstCallbackId) {
        document.getElementById('text').innerText = data.result.content;
      }
    }
    // 接收webview信息
    navigator.qt.onmessage = function (data) {
      var obj = data.data ? JSON.parse(data.data) : {}
      if (obj.callbackId == secondCallbackId) {
        document.getElementById('text').innerText = obj.result.content;
      }
    }

    function requestOne() {
      var message = {
        module: 'Demo*',
        callbackId: firstCallbackId,
        handerName: 'test',
        params: {
          content: 'syberos first request'
        }
      };
      //最终发送给webview内容
      var str = JSON.stringify(message);
      navigator.qt.postMessage(str);
    }

    function requestTwo() {
      var message = {
        module: 'Demo*',
        callbackId: secondCallbackId,
        handerName: 'test',
        params: {
          content: 'syberos second request'
        }
      };
      //最终发送给webview内容
      var str = JSON.stringify(message);
      navigator.qt.postMessage(str);
    }

  </script>
</body>

</html>
